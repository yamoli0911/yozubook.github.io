"use strict";(self["webpackChunkyozubook0_2"]=self["webpackChunkyozubook0_2"]||[]).push([[259],{5259:function(e,t,a){a.r(t),a.d(t,{default:function(){return I}});var o=a(6768),l=a(4232);const s={class:"d-flex justify-content-between align-items-center mb-4"},d=(0,o.Lk)("div",{class:"header d-flex align-items-center"},[(0,o.Lk)("h2",{class:"category bg-white text-primaryDark fw-bold fs-3 me-4 p-2"},"# 優惠券管理")],-1),i=(0,o.Lk)("i",{class:"fa-solid fa-book-medical me-3"},null,-1),n={class:"table caption-top table-hover text-primaryDark"},c=(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",{class:"fw-bold",scope:"col"},"名稱"),(0,o.Lk)("th",{scope:"col"},"折扣百分比"),(0,o.Lk)("th",{scope:"col"},"到期日"),(0,o.Lk)("th",{scope:"col"},"是否啟用"),(0,o.Lk)("th",{scope:"col"},"編輯/刪除")])],-1),p=(0,o.Lk)("td",{class:"ps-5"},[(0,o.Lk)("label",{class:"switch"},[(0,o.Lk)("input",{type:"checkbox"}),(0,o.Lk)("span",{class:"slider"})])],-1),r=(0,o.Lk)("td",null,[(0,o.Lk)("div",{class:"d-flex"},[(0,o.Lk)("div",{class:"editBtn d-flex align-items-center"},[(0,o.Lk)("i",{class:"fa-solid fa-pencil cursor-pointer text-primary fs-4 me-6"})]),(0,o.Lk)("div",{class:"delBtn d-flex align-items-center"},[(0,o.Lk)("i",{class:"fa-solid fa-trash cursor-pointer text-primary fs-4"})])])],-1);function u(e,t,a,u,m,h){const k=(0,o.g2)("CouponModal");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",s,[d,(0,o.Lk)("div",{class:"btn btn-primary text-white",onClick:t[0]||(t[0]=e=>h.openModal("isCreateNew"))},[i,(0,o.eW)("新增優惠券 ")])]),(0,o.Lk)("table",n,[c,(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(m.coupons,(e=>((0,o.uX)(),(0,o.CE)("tr",{key:e.id},[(0,o.Lk)("td",null,(0,l.v_)(e.title),1),(0,o.Lk)("td",null,(0,l.v_)(e.percent)+" %",1),(0,o.Lk)("td",null,(0,l.v_)(h.toData(e.due_date)),1),p,r])))),128))])]),(0,o.bF)(k,{ref:"couponModal",temp:m.temp,isCreateNew:m.isCreateNew,onUpdateCoupons:h.updateCoupon},null,8,["temp","isCreateNew","onUpdateCoupons"])],64)}var m=a(5130);const h={class:"modal fade",ref:"modal",tabindex:"-1"},k={class:"modal-dialog modal-dialog-centered modal"},b={class:"modal-content background-transparent"},L=(0,o.Lk)("div",{class:"modal-header bg-primary text-center p-3"},[(0,o.Lk)("h4",{class:"modal-title text-white"},"新增優惠券")],-1),f={class:"modal-body bg-white p-6"},v={class:"row"},w={class:"mb-3 col"},C=(0,o.Lk)("label",{for:"title",class:"form-label"},"名稱",-1),M={class:"mb-3 col"},g=(0,o.Lk)("label",{for:"code",class:"form-label"},"優惠碼",-1),y={class:"row"},x={class:"mb-3 col"},D=(0,o.Lk)("label",{for:"percent",class:"form-label"},"折扣百分比",-1),_={class:"mb-3 col"},N=(0,o.Lk)("label",{for:"due_date",class:"form-label"},"到期日",-1),$=(0,o.Lk)("p",{class:"fw-bold fs-4 mb-2"},"是否啟用",-1),U={class:"switch"},J=(0,o.Lk)("span",{class:"slider"},null,-1),z={class:"modal-footer bg-white w-100"},V=(0,o.Lk)("button",{type:"button",class:"btn btn-outline-primary","data-bs-dismiss":"modal"},"取消",-1);function E(e,t,a,s,d,i){return(0,o.uX)(),(0,o.CE)("div",h,[(0,o.Lk)("div",k,[(0,o.Lk)("div",b,[L,(0,o.Lk)("div",f,[(0,o.Lk)("div",v,[(0,o.Lk)("div",w,[C,(0,o.bo)((0,o.Lk)("input",{id:"title",type:"text",min:"0",class:"form-control",placeholder:"請輸入名稱","onUpdate:modelValue":t[0]||(t[0]=e=>d.tempModalData.title=e)},null,512),[[m.Jo,d.tempModalData.title,void 0,{trim:!0}]])]),(0,o.Lk)("div",M,[g,(0,o.bo)((0,o.Lk)("input",{id:"code",type:"text",min:"0",class:"form-control",placeholder:"請輸入優惠碼","onUpdate:modelValue":t[1]||(t[1]=e=>d.tempModalData.code=e)},null,512),[[m.Jo,d.tempModalData.code,void 0,{trim:!0}]])])]),(0,o.Lk)("div",y,[(0,o.Lk)("div",x,[D,(0,o.bo)((0,o.Lk)("input",{id:"percent",type:"text",min:"0",class:"form-control",placeholder:"請輸入折扣百分比","onUpdate:modelValue":t[2]||(t[2]=e=>d.tempModalData.percent=e)},null,512),[[m.Jo,d.tempModalData.percent,void 0,{number:!0}]])]),(0,o.Lk)("div",_,[N,(0,o.bo)((0,o.Lk)("input",{id:"due_date",type:"date",min:"0",class:"form-control",placeholder:"到期日","onUpdate:modelValue":t[3]||(t[3]=e=>d.due_date=e)},null,512),[[m.Jo,d.due_date]])])]),$,(0,o.Lk)("label",U,[(0,o.bo)((0,o.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=e=>d.tempModalData.is_enabled=e),"true-value":1,"false-value":0},null,512),[[m.lH,d.tempModalData.is_enabled]]),J])]),(0,o.Lk)("div",z,[V,(0,o.Lk)("button",{type:"button",class:"btn btn-primary text-white",onClick:t[5]||(t[5]=t=>e.$emit("update-Coupons",d.tempModalData,a.isCreateNew))},(0,l.v_)(a.isCreateNew?"確定新增":"確定修改"),1)])])])],512)}var X=a(2894),F=a.n(X),S={props:["isCreateNew","temp"],data(){return{due_date:"",tempModalData:{},modal:""}},watch:{temp:{handler(){this.tempModalData=JSON.parse(JSON.stringify(this.temp))},deep:!0},due_date(){this.tempModalData.due_date=Math.floor(new Date(this.due_date)/1e3)}},methods:{openModal(){this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new(F())(this.$refs.modal)}},A=a(1241);const B=(0,A.A)(S,[["render",E]]);var K=B;function O(e){const t=new Date(1e3*e);return t.toLocaleDateString()}var j={data(){return{temp:{},coupons:{},isCreateNew:!0,isLoading:!1}},components:{CouponModal:K},methods:{toData:O,getCoupons(){this.isLoading=!0,this.$http.get("https://vue3-course-api.hexschool.io/api/yozubook011/admin/coupons").then((e=>{this.coupons=e.data.coupons,this.isLoading=!1})).catch((()=>{this.isLoading=!1}))},openModal(e,t){"isCreateNew"===e?(this.temp={due_date:(new Date).getTime()/1e3,is_enabled:0},this.isCreateNew=!0,this.$refs.couponModal.openModal()):"edit"===e?(this.temp={...t},this.isCreateNew=!1,this.$refs.couponModal.openModal()):"delete"===e&&(this.temp={...t},this.$refs.delModal.openModal())},updateCoupon(e,t){let a="https://vue3-course-api.hexschool.io/api/yozubook011/admin/coupon",o="post";!1===t&&(o="put",a=`https://vue3-course-api.hexschool.io/api/yozubook011/admin/coupon/${e.id}`),this.isLoading=!0,this.$http[o](a,{data:e}).then((e=>{this.isLoading=!1,this.$refs.couponModal.hideModal(),this.getCoupons()})).catch((()=>{this.isLoading=!1,this.pushMsg(!1,"更新","更新優惠券失敗")}))}},mounted(){this.getCoupons()}};const H=(0,A.A)(j,[["render",u]]);var I=H}}]);
//# sourceMappingURL=259.16533034.js.map